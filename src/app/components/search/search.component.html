<!-- Search Tab-->
<div id="searchContentId" name="searchContentName" th:fragment="content" xmlns:th="http://www.thymeleaf.org"
     role="tabpanel" class="tab-pane active">
    <!-- <script type="text/javascript" th:src="@{../js/jquery.tablesorter.js}"></script>
    <link rel="stylesheet" th:href="@{../css/search.css}"/>
    <script type="text/javascript" th:src="@{../js/search.js}"></script>
    <script type="text/javascript" th:src="@{../js/bootstrap-add-clear.min.js}"></script> -->
    <div id="searchFormDivId" name="searchFormDivName" th:fragment="search-form" xmlns:th="http://www.thymeleaf.org" th:remove="tag">
        <form [formGroup]="searchForm" >
            <input type="hidden"  th:name="${_csrf.parameterName}"   th:value="${_csrf.token}"/>
            <fieldset>
                <div class="search-bar">
                    <div class="row margin-0">
                        <div class="col-xs-12">
                            <div class="row">
                                <div class="input-group buscador-principal">
                                    <input id="pageNumber" name="pageNumber" type="text"
                                            hidden="hidden"/>
                                    <input id="totalPageCount" name="totalPageCount" type="text"
                                            hidden="hidden"/>
                                    <input id="totalBibRecordsCount" name="totalBibRecordsCount" type="text"
                                            hidden="hidden"/>
                                    <input id="totalItemRecordsCount" name="totalItemRecordsCount" type="text"
                                            hidden="hidden"/>
                                    <button id="pageSizeChangeButtonId" type="submit"
                                            name="action" value="pageSizeChange"
                                            hidden="hidden"></button>
                                    <div>
                                            <input id="fieldValue" formControlName="fieldValue" name="fieldValue" type="search" placeholder="Type Text Here....." class="form-control"/>
                                              
                                    </div>
                                    <div class="input-group-btn search-panel">
                                        <!-- <select id="fieldName" formControlName="fieldName"
                                                class="form-control btn themed-button themed-button-allfields dropdown-toggle"
                                                 style="width: 170px; border-left-width: 0px;">
                                            <option value="">ALL Fields</option>
                                            <option value="Author_search">Author</option>
                                            <option value="Title_search">Title</option>
                                            <option value="TitleStartsWith">Title Browse(first word)</option>
                                            <option value="Publisher">Publisher</option>
                                            <option value="PublicationPlace">Publication Place</option>
                                            <option value="PublicationDate">Publication Date</option>
                                            <option value="Subject">Subject</option>
                                            <option value="ISBN">ISBN</option>
                                            <option value="ISSN">ISSN</option>
                                            <option value="OCLCNumber">OCLC Number</option>
                                            <option value="Notes">Notes</option>
                                            <option value="CustomerCode">Customer Code</option>
                                            <option value="CallNumber_search">Call Number</option>
                                            <option value="Barcode">Barcode</option>
                                        </select> -->
                                        <select formControlName="fieldName" class="form-control btn themed-button themed-button-allfields dropdown-toggle"
                                        style="width: 170px; border-left-width: 0px;">
                                            <option value="">ALL Fields</option>
                                            <option *ngFor="let fld of searchfieldval" [value]="fld.id">{{fld.name}}</option>
                                        </select>
                                    </div>
                                    <div class="input-group-btn padding-right-10">
                                        <button id="search" (click)="searchRecord()" type="button" name="action" value="search" class="btn themed-button">
                                            Search
                                        </button>
                                    </div>
                                    <div class="input-group-btn padding-right-10">
                                        <button id="resetSearch" [disabled]="!searchForm.dirty" (click)="onReset()" type="button" name="action" value="newSearch" class="btn themed-button themed-button-cancel" >
                                            Reset Search
                                        </button>
                                    </div>
                                    <div class="input-group-btn">
                                        <button type="button" class="btn themed-button themed-button-facet dropdown-toggle" data-toggle="collapse" data-target="#search-filter">
                                            <span id="showFacets" class="pull-left">Show Facets</span> <span class="glyphicon glyphicon-menu-down small pull-right"></span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div id="search-filter" class="row collapse" style="padding-top: 10px; padding-bottom: 15px;">
                                <div class="col-xs-2" style="margin-top: 50px;">
                                    <div class="allfacet">
                                        <label>
                                            <input type="checkbox" id="selectAllFacets"
                                            [checked]="checked" 
                                                   name="selectAllFacets" value="" 
                                                    (click)="checkUncheckAll()" class="facetCheckBox">
                                            <span class="cr margin-top-15"></span>
                                            
                                            <span class="facet-text">&nbsp;Select / Unselect All Facets   </span>
                                        </label>
                                    </div>
                                </div>
                                <div class="col-xs-4 padding-left-30 padding-btm-30" style="padding-bottom: 0px;">
                                    <div class="row">
                                        <h2 style="margin-top: 0px; margin-bottom: 0px;">Bib Facets</h2>
                                    </div>
                                    <div class="row">
                                        <div class="row">
                                            <div class="col-xs-6">
                                                <h4>Owning Institution</h4>
                                                <div class="row padding-left-15">
                                                    <div>
                                                        <label>
                                                            <input type="checkbox" formControlName="owningInstitutionNYPL" [checked]="checked" id="owningInstitutionNYPL"
                                                                   name="owningInstitutionNYPL"  value="NYPL"
                                                                    class="facetCheckBox">
                                                            <span class="cr"></span>
                                                            
                                                            &nbsp;NYPL
                                                        </label>
                                                    </div>
                                                    <div>
                                                        <label>
                                                            <input type="checkbox" formControlName="owningInstitutionCUL" [checked]="checked" id="owningInstitutionCUL"
                                                                   name="owningInstitutionCUL" value="CUL"
                                                                    class="facetCheckBox">
                                                            <span class="cr"></span>
                                                            
                                                            &nbsp;Columbia
                                                        </label>
                                                    </div>
                                                    <div>
                                                        <label>
                                                            <input type="checkbox" formControlName="owningInstitutionPUL" [checked]="checked" id="owningInstitutionPUL"
                                                                   name="owningInstitutionPUL" value="PUL"
                                                                    class="facetCheckBox">
                                                            <span class="cr"></span>
                                                            
                                                            &nbsp;Princeton
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-xs-6">
                                                <h4>Material Type</h4>
                                                <div>
                                                    <label>
                                                        <input type="checkbox" formControlName="Monograph" [checked]="checked" id="monograph" name="monograph"
                                                               value="Monograph"  class="facetCheckBox">
                                                        <span class="cr"></span>
                                                        
                                                        &nbsp;Monograph
                                                    </label>
                                                </div>
                                                <div>
                                                    <label>
                                                        <input type="checkbox"  formControlName="Serial" [checked]="checked" id="serials" name="serials"
                                                                   value="Serial"  class="facetCheckBox">
                                                        <span class="cr"></span>
                                                        
                                                        &nbsp;Serials
                                                    </label>
                                                </div>
                                                <div>
                                                    <label>
                                                        <input type="checkbox" formControlName="others" [checked]="checked" id="others" name="others" value="Other"
                                                                    class="facetCheckBox">
                                                        <span class="cr"></span>
                                                        
                                                        &nbsp;Others
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xs-6  padding-left-30 padding-btm-30 border-style-left-white" style="padding-bottom: 0px;">
                                    <div class="row">
                                        <div class="col-xs-12">
                                            <h2 style="margin-top: 0px; margin-bottom: 0px;">Item Facets</h2>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-xs-4">
                                            <h4>Collection Group</h4>
                                            <div class="row padding-left-15">
                                                <div>
                                                    <label>
                                                        <input type="checkbox" formControlName="shared" [checked]="checked" id="shared" name="shared" value="Shared"
                                                                class="facetCheckBox">
                                                        <span class="cr"></span>
                                                        
                                                        &nbsp;Shared
                                                    </label>
                                                </div>
                                                <div>
                                                    <label>
                                                        <input type="checkbox" formControlName="private" [checked]="checked" id="private" name="private" value="Private"
                                                                class="facetCheckBox">
                                                        <span class="cr"></span>
                                                        
                                                        &nbsp;Private
                                                    </label>
                                                </div>
                                                <div>
                                                    <label>
                                                        <input type="checkbox" formControlName="open" [checked]="checked" id="open" name="open" value="Open"
                                                                class="facetCheckBox">
                                                        <span class="cr"></span>
                                                        
                                                        &nbsp;Open
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-xs-4">
                                            <h4>Availability</h4>
                                            <div>
                                                <label>
                                                    <input type="checkbox" formControlName="Available" [checked]="checked" id="available" name="available"
                                                           value="Available" class="facetCheckBox">
                                                    <span class="cr"></span>
                                                    
                                                    &nbsp;In ReCAP
                                                </label>
                                            </div>
                                            <div>
                                                <label>
                                                    <input type="checkbox" formControlName="notAvailable" [checked]="checked" id="notAvailable" name="notAvailable"
                                                           value="NotAvailable" class="facetCheckBox">
                                                    <span class="cr"></span>
                                                    
                                                    &nbsp;Out
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-xs-4">
                                            <h4>Use Restriction</h4>
                                            <div>
                                                <label>
                                                    <input type="checkbox" formControlName="NoRestrictions" [checked]="checked" id="noRestriction" name="noRestriction"
                                                           value="NoRestrictions"  class="facetCheckBox">
                                                    <span class="cr"></span>
                                                    
                                                    &nbsp;No Restriction
                                                </label>
                                            </div>
                                            <div>
                                                <label>
                                                    <input type="checkbox" formControlName="InLibraryUse" [checked]="checked" id="inLibraryUse" name="inLibraryUse"
                                                           value="InLibraryUse"  class="facetCheckBox">
                                                    <span class="cr"></span>
                                                    
                                                    &nbsp;In Library Use
                                                </label>
                                            </div>
                                            <div>
                                                <label>
                                                    <input type="checkbox" formControlName="SupervisedUse" [checked]="checked" id="supervisedUse" name="supervisedUse"
                                                           value="SupervisedUse"  class="facetCheckBox">
                                                    <span class="cr"></span>
                                                    
                                                    &nbsp;Supervised Use
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="search-results-container" *ngIf="showresultdiv">
                    <div class="row">
                        <div class="col-xs-12">
                            <div class="divider-horizontal margin-top-10 margin-btm-10"></div>
                            <!-- <div class="row margin-btm-10" data-th-if="">
                                <div class="col-sm-12">
                                    <div class="bg-danger text-danger padding-10"><span class="margin-right-05 glyphicon glyphicon-warning-sign"></span><span th:text="*{errorMessage}"></span></div>
                                </div>
                            </div> -->
                            <div id="searchResultsDiv" name="searchResultsDiv" th:if="*{searchResultRows.size() &gt; 0 &amp;&amp; showResults}">
                                <div class="row">
                                    <div class="col-xs-12">
                                        <div class="pull-left margin-btm-0 margin-right-35" style="margin-top: -20px; margin-bottom: -10px;">
                                            <div id="paginationId" name="paginationName">
                                                <ul class="pagination">
                                                    <li [ngClass]="(firstbutton==true)?'disabled':''" >
                                                        <span (click)="firstapi()">First</span>
                                                       
                                                    </li>
                                                    <li [ngClass]="(previousbutton==true)?'disabled':''">
                                                        <span (click)="previousapi()" >Previous</span>
                                                       
                                                    </li>
                                                    <li [ngClass]="(nextbutton==true)?'disabled':''">
                                                        <span (click)="nextapi()">Next</span>
                                                        
                                                    </li>
                                                    <li [ngClass]="(lastbutton==true)?'disabled':''">
                                                        <span (click)="lastapi()">Last</span>
                                                        
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="pull-left margin-top-05 parent">
                                            <div class="recap-status">
                                                <div class="inline-box margin-right-10">
                                                    <img class="status" src="../../../../assets/images/inRecap.png" alt="In ReCAP" style="width:20px;height:25px;"/><span class="align-middle padding-5">In ReCAP</span>
                                                </div>
                                                <div class="inline-box margin-right-10">
                                                    <img class="status" src="../../../../assets/images/out.png" alt="Out" style="width:20px;height:25px;"/><span class="align-middle padding-5">OUT</span>
                                                </div>
                                                <div class="inline-box margin-right-10">
                                                    <img class="status" src="../../../../assets/images/mixed.png" alt="Partial Availability" style="width:20px;height:20px"/><span class="align-middle padding-5">Partial Availability</span>
                                                </div>
                                              
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--show entries start-->
                                <div id="showEntriesAndNumFoundDiv" name="showEntriesAndNumFoundDiv" class="row">
                                    <div class="col-sm-2 margin-top-05 show-entries-section">
                                        <div class="">
                                            <span class="show-title">Show Entries</span>
                                            <select id="numOfRecordsId" name="pageSize" [(ngModel)]="showentries" class="themed-input" (change)="onPageSizeChange(showentries)" [ngModelOptions]="{standalone: true}" style="margin-left: 5px;">
                                                <option value="10" selected="selected">10</option>
                                                <option value="25">25</option>
                                                <option value="50">50</option>
                                                <option value="100">100</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-sm-7 margin-top-10"><div class="row" style="font-family: 'roboto-condensed' , sans-serif;color: #848484;font-size: 17px !important;">OI - Owning Institution, CC - Customer Code, CGD - Collection Group Designation, SH - Summary Holdings</div>
                                    </div>
                                    <div class="col-sm-3 text-right" style="text-align: right;font-family: 'roboto-condensed' , sans-serif;color: #848484;font-size: 17px !important;" >
                                        <span>Bibliographic Results Found: <span>{{searchVal['totalBibRecordsCount']}}</span></span><br>
                                        <span>Item Results Found: <span>{{searchVal['totalItemRecordsCount']}}</span></span>
                                        
                                    </div>
                                </div>
                                <!--show entries end-->
                            <!--tree grid start-->

                               <p-table #dt [columns]="cols" [autoLayout]="true" [value]="searchVal['searchResultRows']" [paginator]="false" [rows]="10" [showCurrentPageReport]="false" 
                               currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" [rowsPerPageOptions]="[10,25,50,100]" paginatorPosition="" selectionMode="checkbox" [(selection)]="selectedNodes1" dataKey="title" (onRowSelect)="onRowSelect($event)" (onRowUnselect)="onRowUnselect($event)">
                              
                                <ng-template pTemplate="header" let-columns>
                                    <tr>
                                        <th style="width: 3em">
                                            <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                                        </th>
                                        <!-- <th style="width: 3em"></th> -->
                                        
                                        <th *ngFor="let col of columns" [pSortableColumn]="col.field">
                                            
                                            {{col.header}}
                                            <p-sortIcon [field]="col.field" ariaLabel="Activate to sort" ariaLabelDesc="Activate to sort in descending order" ariaLabelAsc="Activate to sort in ascending order"></p-sortIcon>
                                        </th>
                                    </tr>
                                    
                                       
                                        <!-- <tr>
                                            
                                        <th style="width: 3em">
                                        </th>
                                        
                                        <th *ngFor="let col of columns" [ngSwitch]="col.field">
                                            <input  style="width:100px" pInputText type="text" (input)="dt.filter($event.target.value, col.field, 'contains')">
                                           &nbsp;
                                        </th>
                                    </tr>  -->
                                   
                                    
                                </ng-template>
                                <ng-template pTemplate="body" let-rowData let-expanded="expanded" let-columns="columns">
                                    <tr>
                                        
                                        <td *ngIf="rowData.searchItemResultRows==''">
                                            <p-tableCheckbox [value]="rowData"></p-tableCheckbox>
                                        </td>
                                        <td *ngIf="rowData.searchItemResultRows!=''">
                                            <a href="#" [pRowToggler]="rowData">
                                                <i [ngClass]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></i>
                                            </a>
                                        </td>
                                       
                                        <td *ngFor="let col of columns">
                                            {{rowData[col.field]}}
                                        </td>
                                    </tr>
                                </ng-template>
                                <ng-template pTemplate="rowexpansion" let-rowData let-columns="columns">
                                    <tr>
                                        <td [attr.colspan]="columns.length + 1">
                                            <div class="p-grid ui-fluid" style="font-size:16px;padding:20px" [@rowExpansionTrigger]="'active'">
                                                <div class="p-col-12 p-md-9">
                                                    <div class="p-grid" *ngIf="rowData.searchItemResultRows==''"></div>
                                                    <div class="p-grid" *ngIf="rowData.searchItemResultRows!=''">
                                                        <p-table [columns]="cols1" selectionMode="checkbox" [(selection)]="selectedNodes2" [value]="rowData.searchItemResultRows" >
                                                            <ng-template pTemplate="header" let-columns>
                                                                <tr>
                                                                    <th style="width: 3em">
                                                                        <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                                                                    </th>
                                                                    <th *ngFor="let col of columns">
                                                                        {{col.header}}
                                                                    </th>
                                                                </tr>
                                                            </ng-template>
                                                            <ng-template pTemplate="body" let-rowData let-columns="columns">
                                                                <tr>
                                                                    <td>
                                                                        <p-tableCheckbox [value]="rowData"></p-tableCheckbox>
                                                                    </td>
                                                                    <td *ngFor="let col of columns">
                                                                        {{rowData[col.field]}}
                                                                    </td>
                                                                </tr>
                                                            </ng-template>
                                                        </p-table>
                                                       
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                </ng-template>
                                <!-- <ng-template pTemplate="summary">
                                    <ul>
                                        <li *ngFor="let car of selectedNodes1" style="text-align: left">
                                            {{car.vin + ' - ' + car.brand + ' - ' + car.year + ' - ' + car.color}}
                                        </li>
                                    </ul>
                                </ng-template> -->
                                <!-- <ng-template pTemplate="summary">
                                    <ul>
                                        <li *ngFor="let car of selectedNodes2" style="text-align: left">
                                            {{car.callNumber }}
                                        </li>
                                    </ul>
                                </ng-template> -->
                            </p-table>
                             <!--tree grid end-->
                        
                            </div><!--show result div end-->
                            <div style="clear:both">&nbsp;</div>
                            <!--show entries export start-->
                            <div id="paginationAndButtons" name="paginationAndButtons" class="margin-top-15 export-buttons">
                            <div class="pull-left" style="margin-top: -20px;">
                            <div id="paginationId" name="paginationName">
                                <ul class="pagination">
                                    <li [ngClass]="(firstbutton==true)?'disabled':''" >
                                        <span (click)="firstapi()">First</span>
                                       
                                    </li>
                                    <li [ngClass]="(previousbutton==true)?'disabled':''">
                                        <span (click)="previousapi()" >Previous</span>
                                       
                                    </li>
                                    <li [ngClass]="(nextbutton==true)?'disabled':''">
                                        <span (click)="nextapi()">Next</span>
                                        
                                    </li>
                                    <li [ngClass]="(lastbutton==true)?'disabled':''">
                                        <span (click)="lastapi()">Last</span>
                                        
                                    </li>
                                </ul>
                            </div>
                            </div>
                            <div style="margin-top: -20px;">
                            <button id="export" [disabled]="clicked" (click)="setFileName();dt.exportCSV({selectionOnly:true})" name="action" value="export" type="button" class="btn btn-primary pull-right" style="margin-right: 10px;">Export Selected Records
                            </button>
                            <button id="requestButton" [routerLink]="['/dashboard/request']" [disabled]="clicked" type="button" name="action" value="request" class="btn btn-primary pull-right" style="margin-right: 10px;">Request Selected
                            Items(s)
                            </button>
                            </div>
                            </div>
                            <!--show entries export end-->
                        </div>
                    </div>
                </div>
            </fieldset>
        </form>
    </div>
</div>

       

<!-- Search Tab-->
