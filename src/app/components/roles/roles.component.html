<html>

<head>
    <title>Roles</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>

<body>
    <div id="rolesContentId" name="rolesContentName">
        <div id="rolesFormDivId" name="rolesFormDivName">
            <form id="roles-form" name="roles-form" class="form-horizontal">
                <input type="hidden" />
                <fieldset>
                    <div role="tabpanel" class="tab-pane" id="recaprole">
                        <div *ngIf="rolesPanel" id="role-searchview" class="roles-main-section" data-th-if="*{showIntial}">
                            <div class="col-sm-7">Provide one or more data to search. Empty search would return all data.
                            </div>
                            <div class="col-lg-12 text-right roleCreateNewlink" style="margin-top: -20px;"><a (click)="createRole()" id="createRoleLink" style="cursor: pointer !important;"><span
                                class="glyphicon glyphicon-plus-sign"></span> Create Role</a></div>
                            <div class="search-bar">
                                <div class="row margin-0">
                                    <div class="col-xs-12  padding-0">
                                        <form id="rolesearch">
                                            <div class="input-group buscador-principal search-role-section">
                                                <input id="pageNumber" name="pageNumber" type="text" th:field="*{pageNumber}" hidden="hidden" />
                                                <input id="totalPageCount" name="totalPageCount" type="text" th:field="*{totalPageCount}" hidden="hidden" />
                                                <input id="totalRecordsCount" name="totalBibRecordsCount" type="text" th:field="*{totalRecordCount}" hidden="hidden" />
                                                <input id="permissioinList" name="permissioinList" type="text" th:field="*{permissionNameList}" hidden="hidden" />
                                                <button id="pageSizeChangeButtonId" type="submit" name="action" value="pageSizeChange" hidden="hidden"></button>
                                                <div class="col-md-6 col-sm-4 padding-right-25 padding-left-25">
                                                    <label class="fontcolor-dark margin-btm-10">Role Name</label>
                                                    <input id="roleName" class="form-control themed-input" [ngModelOptions]="{standalone: true}" [(ngModel)]="roleName" name="roleName" type="text" />
                                                </div>
                                                <div class="col-md-6 col-sm-4 padding-right-25 padding-left-25">
                                                    <label class="fontcolor-dark margin-btm-10">Permission Name</label>
                                                    <input id="associatedFunctionality" class="form-control themed-input" [ngModelOptions]="{standalone: true}" [(ngModel)]="permissionName" name="associatedFunctionality" type="text" />
                                                </div>
                                                <div class="input-group-btn search-panel padding-left-70 padding-right-10">
                                                    <button id="searchRoles" class="btn themed-button themed-button-search" value="searchRoles" (click)="searchRoles()">Search
                                            </button>
                                                </div>
                                                <div class="input-group-btn">
                                                    <button id="clearRolesForm" class="btn themed-button themed-button-cancel" type="reset" value="clear" (click)="resetFields()">Clear Search
                                            </button>
                                                </div>
                                            </div>
                                        </form>
                                    </div>

                                </div>
                            </div>
                            <div *ngIf="showResults" class="search-results-container">
                                <div class="row">
                                    <div class="col-xs-12">
                                        <div class="row margin-btm-10">
                                            <div *ngIf="successDiv" class="col-sm-12 text-left">
                                                <div class="alert alert-success" role="alert" style="margin-top: 10px;margin-bottom: -5px;"><span class="margin-right-05 glyphicon glyphicon-ok-sign"></span><span>{{deleteResponse['message']}}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row margin-top-0">
                                            <div class="col-sm-6 margin-top-0">
                                                <h3 class="margin-0">Search Results</h3>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="divider-horizontal margin-top-10 margin-btm-10"></div>
                                <div *ngIf="errorMessageDiv" class="row margin-btm-10 errorMessage" id="errorMessageId">
                                    <div class="col-sm-12">
                                        <div class="alert alert-danger"><span class="margin-right-05 glyphicon glyphicon-warning-sign"></span><span>{{rolesVal['errorMessage']}}</span>
                                        </div>
                                    </div>
                                </div>

                                <div *ngIf="rolesSearchResultsDiv">
                                    <div id="showEntriesAndNumFoundDiv" name="showEntriesAndNumFoundDiv" class="row">
                                        <div class="col-sm-2 margin-top-05 show-entries-section">
                                            <div class="" style="margin-top: -10px;">
                                                <span class="show-title">Show Entries</span>
                                                <select id="numOfRecordsId" name="numOfRecordsName" [(ngModel)]="numOfRecordsId" class="themed-input" [ngModelOptions]="{standalone: true}" (change)="pageSizeChange(numOfRecordsId)" style="margin-left: 5px;">
                                            <option value="10" selected="selected">10</option>
                                            <option value="25">25</option>
                                            <option value="50">50</option>
                                            <option value="100">100</option>
                                        </select>
                                            </div>
                                        </div>
                                        <div class="col-sm-9 col-md-10 col-lg-7"></div>
                                        <div class="col-sm-12 col-md-12 col-lg-3 text-right pull-right" style="margin-top:-10px;">
                                            <h4><span>Total Results Found:
                                            <span>{{rolesVal['totalRecordCount']}}</span></span>
                                            </h4>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class=" roleDetails" style="margin-top: -5px;">
                                            <table class="table table-striped margin-btm-0" id="">
                                                <thead class="tablesorter-headerRow">
                                                    <tr>
                                                        <th width="10%">Role Name</th>
                                                        <th width="20%">Role Description</th>
                                                        <th width="60%">Permission Names</th>
                                                        <th class="text-center" width="10%">Action</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr id="rowData_results_{{i}}" *ngFor="let searchResult of rolesVal['rolesSearchResults']; let i= index" class="parentRow">

                                                        <input type="hidden" />
                                                        <td id="colData_rn_{{i}}">
                                                            <input type="hidden" />
                                                            <span>{{searchResult.rolesName}}</span>
                                                        </td>
                                                        <td id="colData_rd_{{i}}">
                                                            <input type="hidden" />
                                                            <span>{{searchResult.rolesDescription}}</span>
                                                        </td>
                                                        <td id="colData_pn_{{i}}">
                                                            <input type="hidden" />
                                                            <span>{{searchResult.permissionName}}</span>
                                                        </td>
                                                        <td id="colData_editDelete_{{i}}" class="text-center">
                                                            <div class="edit-link margin-left-05 margin-right-05 editRole">
                                                                <a id="editUserLink_{{i}}">
                                                                    <span class="glyphicon glyphicon-pencil" title="Edit Role" (click)="editRole(searchResult['roleId'],searchResult['rolesName'],searchResult['rolesDescription'],searchResult['permissionName'])" style="cursor: pointer;">
                                                            </span>
                                                                </a>
                                                                <a id="deleteUserLink_{{i}}">
                                                                    <span class="glyphicon glyphicon-trash" title="Delete Role" (click)="deleteRole(searchResult['roleId'],searchResult['rolesName'],searchResult['rolesDescription'],searchResult['permissionName'])" style="cursor: pointer;margin-left: 5px;">
                                                             </span>
                                                                </a>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-12">
                                                <div class="margin-btm-0 pull-right" style="margin-top:-10px; margin-bottom:-30px;">
                                                    <div id="reportPaginationId" name="reportPaginationName" class="pull-right">
                                                        <ul class="pagination" id="reportPaginationUl">
                                                            <li [ngClass]="(firstbutton==true)?'disabled':''">
                                                                <span id="btn_first" (click)="firstCall()">First</span>
                                                            </li>
                                                            <li [ngClass]="(previousbutton==true)?'disabled':''">
                                                                <span id="btn_previous" (click)="previousCall()">Previous</span>
                                                            </li>
                                                            <li [ngClass]="(nextbutton==true)?'disabled':''">
                                                                <span id="btn_next" (click)="nextCall()">Next</span>
                                                            </li>
                                                            <li [ngClass]="(lastbutton==true)?'disabled':''">
                                                                <span id="btn_last" (click)="lastCall()">Last</span>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div *ngIf="createRoleSectionDiv" id="createRoleSection" class="create-role-section">
                            <div class="row margin-top-0">
                                <div class="col-sm-6 margin-top-0">
                                    <h3 class="margin-0">Create Role</h3>
                                </div>
                                <div class="col-sm-6 text-right backtext"><a id="createGoBackLink" (click)="goBack($event)" style="cursor: pointer !important;"><span
                            class="glyphicon glyphicon-menu-left" ></span> Go Back</a></div>
                            </div>
                            <div *ngIf="successMessageRoleCreateionDiv" id="successMessageRoleCreateion" class="row margin-btm-10">
                                <div class="col-sm-12 text-left">
                                    <div class="alert alert-success" role="alert" id="success-alert"><span class="margin-right-05 glyphicon glyphicon-ok-sign"></span><span>{{rolesVal['message']}}</span></div>
                                </div>
                            </div>
                            <div *ngIf="errorMessageRoleCreateionDiv" id="errorMessageRoleCreateion" class="row margin-btm-10">
                                <div class="col-sm-12">
                                    <div class="alert alert-danger"><span class="margin-right-05 glyphicon glyphicon-warning-sign"></span><span>{{rolesVal['errorMessage']}}</span></div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12 divider-horizontal margin-top-10 margin-btm-10"></div>
                            </div>
                            <div class="buscador-principal">
                                <div class="row margin-top-25 margin-btm-30">
                                    <div class="col-sm-12">
                                        <div class="row">
                                            <div class="row">
                                                <div class="col-md-8 col-sm-6">
                                                    <div class="form-group">
                                                        <div class="col-sm-3 col-sm-4 text-right margin-top-15"><label for="roleNameId" class="fontcolor-dark">Role Name <span class="error-color">*</span></label></div>
                                                        <div class="col-sm- col-sm-6">
                                                            <input type="text" id="roleNameId" name="roleName" [ngModelOptions]="{standalone: true}" [(ngModel)]="roleNameId" class="form-control themed-input" />
                                                            <span *ngIf="roleNameErrorMessageDiv" id="roleNameErrorMessage" style="color: red;">Role Name is required.</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-8 col-sm-6">
                                                    <div class="form-group">
                                                        <div class="col-sm-3 col-sm-4 text-right margin-top-15"><label for="roleDescriptionId" class="fontcolor-dark">Role Description <span class="error-color">*</span></label></div>
                                                        <div class="col-sm- col-sm-6">
                                                            <input type="text" id="roleDescriptionId" name="roleDescriptionId" class="form-control themed-input" [ngModelOptions]="{standalone: true}" [(ngModel)]="roleDescriptionId" maxlength="45" />
                                                            <span *ngIf="roleDescriptionErrorMessageDiv" id="roleDescriptionErrorMessage" style="color: red;">Role description is required.</span>
                                                            <p>Characters Remaining : <span id="roleDescCharactersRemaining">45</span></p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6 col-sm-6" id="permissionName">
                                                    <div class="form-group">
                                                        <div class="col-md-4 col-sm-6 text-right margin-top-05"><label for="permissionNameId" class="fontcolor-dark">Permission Names <span class="error-color">*</span></label></div>
                                                        <div class="col-md-8 col-sm-6">
                                                            <div class="">
                                                                <ng-select id="permissionNameId" [items]="permissionNamesList" [multiple]="true" bindLabel="name" [selectableGroup]="true" [selectableGroupAsModel]="false" [closeOnSelect]="false" bindValue="id" [ngModelOptions]="{standalone: true}" [(ngModel)]="permissionNameId"
                                                                    placeholder="Select One or More">
                                                                    <ng-template name="itemList" ng-option-tmp let-item="item" let-item$="item$" let-index="index">
                                                                        <input id="item-{{index}}" type="checkbox" [ngModelOptions]="{standalone: true}" [ngModel]="item$.selected" /> {{item}}
                                                                    </ng-template>
                                                                </ng-select>
                                                                <span id="permErrorMessage" *ngIf="permissionNamesErrorMessageDiv" id="permissionNamesErrorMessage" style="color: red;">Permission Name is required.</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-6 col-md-6 col-lg-6 text-center">
                                                <button type="button" class="pull-right btn btn-default themed-button btn-primary" id="createrolesubmit" (click)="saveCreateRole()">Create Role</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div *ngIf="editRoleSectionDiv" id="editRoleSection" class="edit-role-section">
                            <div class="row margin-top-0">
                                <div class="col-sm-6 margin-top-0">
                                    <h3 class="margin-0">Edit Role</h3>
                                </div>
                                <div class="col-sm-6 text-right backtext"><a (click)="goBack($event)" id="editGoBackLink" style="cursor: pointer !important;"><span
                        class="glyphicon glyphicon-menu-left"></span> Go Back</a></div>
                            </div>
                            <div *ngIf="successMessageEditRoleDiv" id="successMessageEditRole" class="row margin-btm-10">
                                <div class="col-sm-12 text-left">
                                    <div class="alert alert-success" role="alert"><span class="margin-right-05 glyphicon glyphicon-ok-sign"></span><span>{{rolesVal['message']}}</span></div>
                                </div>
                            </div>
                            <div *ngIf="errorMessageEditRoleDiv" id="errorMessageEditRole" class="row margin-btm-10">
                                <div class="col-sm-12">
                                    <div class="alert alert-danger"><span class="margin-right-05 glyphicon glyphicon-warning-sign"></span><span>{{rolesVal['errorMessage']}}</span></div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-xs-12 divider-horizontal margin-top-10 margin-btm-10"></div>
                            </div>
                            <div class="buscador-principal">
                                <div class="row margin-top-25 margin-btm-30">
                                    <div class="col-sm-12">
                                        <div class="row">
                                            <div class="row">
                                                <div class="col-md-8 col-sm-6">
                                                    <div class="form-group">
                                                        <div class="col-sm-3 col-sm-4 text-right margin-top-15"><label for="roleId" class="fontcolor-dark"><span class="error-color"></span></label></div>
                                                        <div class="col-sm-6 col-sm-4">
                                                            <input type="hidden" id="roleId" name="roleId" hidden="hidden" class="form-control themed-input" />
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-8 col-sm-6">
                                                    <div class="form-group">
                                                        <div class="col-sm-3 col-sm-4 text-right margin-top-15"><label for="editRoleName" class="fontcolor-dark">Role Name <span class="error-color">*</span></label></div>
                                                        <div class="col-sm- col-sm-6">
                                                            <input type="text" id="editRoleName" name="roleName" [ngModelOptions]="{standalone: true}" [(ngModel)]="editRoleName" class="form-control themed-input" />
                                                            <span *ngIf="editRoleNameErrorMessageDiv" id="editRoleNameErrorMessage" style="color: red;">Role Name is required.</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-8 col-sm-6">
                                                    <div class="form-group">
                                                        <div class="col-sm-3 col-sm-4 text-right margin-top-15"><label for="editRoleDescription" class="fontcolor-dark">Role Description <span class="error-color">*</span></label></div>
                                                        <div class="col-sm- col-sm-6">
                                                            <input type="text" id="editRoleDescription" name="roleName" [ngModelOptions]="{standalone: true}" [(ngModel)]="editRoleDescription" class="form-control themed-input" onkeyup="editDescLengthValidation(this)" maxlength="45" />
                                                            <span *ngIf="editRoleDescriptionErrorMessageDiv" id="editRoleDescriptionErrorMessage" style="color: red;">Role description is required.</span>
                                                            <p id="charactersRemainingInRoleDesc" style="display: none">Characters Remaining : <span id="editRoleDescCharactersRemaining">45</span></p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6 col-sm-6" id="editPermissionName">
                                                    <div class="form-group">
                                                        <div class="col-md-4 col-sm-6 text-right margin-top-05"><label for="editPermissionNameId" class="fontcolor-dark">Permission Names <span class="error-color">*</span></label></div>
                                                        <div class="col-md-8 col-sm-6">
                                                            <div class="" data-th-if="*{selectedPermissionNames ne null}">
                                                                <ng-select id="editPermissionNameId" [items]="permissionNamesList" [multiple]="true" bindLabel="name" [selectableGroup]="true" [selectableGroupAsModel]="false" [closeOnSelect]="false" bindValue="id" [ngModelOptions]="{standalone: true}" [(ngModel)]="editPermissionNameId">
                                                                    <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
                                                                        <input id="item-{{index}}" type="checkbox" [ngModelOptions]="{standalone: true}" [ngModel]="item$.selected" /> {{item}}
                                                                    </ng-template>
                                                                </ng-select>
                                                                <span *ngIf="editPermissionNamesErrorMessageDiv" id="editPermissionNamesErrorMessage" style="color: red;">Permission Name is required.</span>
                                                            </div>
                                                        </div>
                                                    </div>

                                                </div>
                                            </div>

                                        </div>
                                        <div class="row">
                                            <div class="col-sm-6 col-md-6 col-lg-6 text-center">
                                                <!-- <button type="submit" name="action" value="editRole" class="btn btn-default themed-button btn-primary" id="editRolesubmitHdn" style="display: none;">Edit Role</button> -->
                                                <button class="pull-right btn btn-default themed-button btn-primary" id="editRolesubmit" (click)="saveEditedRole(roleId,editRoleName,editRoleDescription,editPermissionNameId)">Edit Role</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div *ngIf="deleteRoleSectionDiv" id="deleteRoleSection" class="delete-role-section">
                            <div class="row margin-top-0">
                                <div class="col-sm-6 margin-top-0">
                                    <h3 class="margin-0">Delete Role</h3>
                                </div>
                                <div class="col-sm-6 text-right backtext"><a (click)="goBack($event)" id="deleteGoBackLink" style="cursor: pointer !important;"><span
                        class="glyphicon glyphicon-menu-left"></span> Go Back</a></div>
                            </div>
                            <input id="afterDelPageNumber" name="afterDelPageNumber" type="text" th:field="${rolesForm.afterDelPageNumber}" hidden="hidden" />
                            <input id="afterDelTotalPageCount" name="afterDelTotalPageCount" type="text" th:field="${rolesForm.afterDelTotalPageCount}" hidden="hidden" />
                            <input id="afterDelPageSize" name="afterDelPageSize" type="text" th:field="${rolesForm.afterDelPageSize}" hidden="hidden" />
                            <div *ngIf="successMessageDeleteRoleDiv" id="successMessageDeleteRole" class="row margin-btm-10">
                                <div class="col-sm-12 text-left">
                                    <div class="alert alert-success" role="alert"><span class="margin-right-05 glyphicon glyphicon-warning-sign"></span><span>{{rolesVal['message']}}</span></div>
                                </div>
                            </div>
                            <div *ngIg="errorMessageDeleteRoleDiv" id="errorMessageDeleteRole" class="row margin-btm-10">
                                <div class="col-sm-12">
                                    <div class="alert alert-danger"><span class="margin-right-05 glyphicon glyphicon-warning-sign"></span><span>{{rolesVal['errorMessage']}}</span></div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-xs-12 divider-horizontal margin-top-10 margin-btm-10"></div>
                            </div>
                            <div class="buscador-principal">
                                <div class="row margin-top-25 margin-btm-30" style="margin-top: 60px;">
                                    <div class="col-sm-12">
                                        <div class="row">
                                            <div class="row">
                                                <div class="col-md-8 col-sm-6">
                                                    <div class="form-group">
                                                        <div class="col-sm-3 col-sm-4 text-right margin-top-15"><label for="roleNameId" class="fontcolor-dark">Role Name <span class="error-color">*</span></label></div>
                                                        <div class="col-sm-6 col-sm-6">
                                                            <input type="text" id="deleteRoleNameId" name="roleName" readonly="readonly" [ngModelOptions]="{standalone: true}" [ngModel]="deleteRoleNameId" class="form-control themed-input" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-8 col-sm-6">
                                                    <div class="form-group">
                                                        <div class="col-sm-3 col-sm-4 text-right margin-top-15"><label for="deleteRoleDescriptionId" class="fontcolor-dark">Role Description <span class="error-color">*</span></label></div>
                                                        <div class="col-sm-6 col-sm-6">
                                                            <input type="text" id="deleteRoleDescriptionId" name="roleName" readonly="readonly" [ngModelOptions]="{standalone: true}" [ngModel]="deleteRoleDescriptionId" class="form-control themed-input" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6 col-sm-6" id="deletePermissionName">
                                                    <div class="form-group">
                                                        <div class="col-md-4 col-sm-6 text-right margin-top-05"><label for="deletePermissionNameId" class="fontcolor-dark">Permission Names <span class="error-color">*</span></label></div>
                                                        <div class="col-md-8 col-sm-6">
                                                            <div class="">
                                                                <!-- <select id="deletePermissionNameId"
                                                        multiple="multiple"
                                                        disabled="disabled"
                                                        class="form-control themed-input themed-select multiSelectPermissionName"
                                                        [ngModelOptions]="{standalone: true}" [ngModel]="deletePermissionNameId"
                                                        name="permissionNamesForDelete">
                                                        
                                                    <option th:each="permission : *{permissionNameList}" th:value="${permission}" th:text="${permission}" th:selected="${rolesForm.selectedPermissionNames.contains(permission)}"></option>
                                                </select> -->
                                                                <ng-select id="deletePermissionNameId" disabled="disabled" [items]="permissionNamesList" [multiple]="true" bindLabel="name" [selectableGroup]="true" [selectableGroupAsModel]="false" [closeOnSelect]="false" bindValue="id" [ngModelOptions]="{standalone: true}"
                                                                    [(ngModel)]="deletePermissionNameId">
                                                                    <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
                                                                        <input id="item-{{index}}" type="checkbox" [ngModelOptions]="{standalone: true}" [ngModel]="item$.selected" /> {{item}}
                                                                    </ng-template>
                                                                </ng-select>
                                                            </div>
                                                        </div>
                                                    </div>

                                                </div>
                                            </div>

                                        </div>
                                        <div class="row">
                                            <div class="col-xs-12 text-center">
                                                <!--<button type="submit" name="action" value="loadCreateRole" class="btn btn-default themed-button btn-primary" id="createrolesubmitHdn" style="display: none;">Submit</button>-->
                                                <button type="button" class="btn btn-default themed-button btn-primary" id="deleteRole" (click)="deleteFromDb()">Delete Role</button>
                                                <!--<button type="reset" class="btn btn-default themed-button themed-button-cancel" value="clear" id="createrequestclear" onclick="resetDefault()">Clear</button>-->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </fieldset>
            </form>
        </div>
    </div>
</body>

</html>